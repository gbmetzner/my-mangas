angular.module("myMangas",["ngRoute","ui.bootstrap","ngFileUpload","publisher.controllers","publisher.services","publisher.routes","collection.controllers","collection.services","collection.routes","manga.controllers","manga.services","manga.routes"]),angular.module("collection.controllers",["collection.services","publisher.services","ngDialog"]).controller("NewCollectionController",["$scope","CollectionService","PublisherService",function(e,n,t){e.alerts=[],e.getPublishers=function(e){return t.findByName(e).then(function(e){return e.data.items.map(function(e){return e.name})})},e.legend="Add New Collection",e.save=function(t){e.collectionForm.$valid&&n.save(t).then(function(n){e.reset(),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},e.reset=function(){e.collection={publisher:"",name:"",searchParam:"",isComplete:!1}},e.closeAlert=function(n){e.alerts.splice(n,1)}}]).controller("ListCollectionController",["$scope","$timeout","CollectionService","ngDialog",function(e,n,t,a){var o={publisher:"",name:""};e.alerts=[];var i;e.$watchGroup(["collection.publisher","collection.name"],function(e){(e[0]||e[1])&&(i&&n.cancel(i),i=n(function(){o={publisher:e[0]?e[0]:"",name:e[1]?e[1]:""},l(1,0)},350))}),e.openRemoveDialog=function(n){e.collectionToRemove=n,a.openConfirm({template:"removeCollectionTemplate",className:"ngdialog-theme-default",scope:e}).then(function(n){t.remove(n).then(function(n){l(e.bigCurrentPage,e.itemsPerPage*(e.bigCurrentPage-1)),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},function(){})};var l=function(n,a){e.itemsPerPage=10,e.maxSize=5,e.bigCurrentPage=n,t.paginate({collection:o,limit:e.itemsPerPage,skip:a}).then(function(n){e.items=n.data.items,e.bigTotalItems=n.data.totalRecords},function(e){})};e.setPage=function(n){e.bigCurrentPage=n},e.pageChanged=function(){l(e.bigCurrentPage,e.itemsPerPage*(e.bigCurrentPage-1))},l(1,0),e.closeAlert=function(n){e.alerts.splice(n,1)}}]).controller("UpdateCollectionController",["$scope","$routeParams","CollectionService",function(e,n,t){e.alerts=[],e.legend="Update Collection";var a=null,o=function(){t.edit(n.id).then(function(n){e.collection=n.data.collection,a=angular.copy(e.collection)},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})};o(),e.save=function(n){e.collectionForm.$valid&&t.update(n).then(function(n){a=angular.copy(e.collection),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},e.reset=function(){o()},e.closeAlert=function(n){e.alerts.splice(n,1)}}]),angular.module("manga.controllers",["manga.services","collection.services","ngDialog"]).controller("NewMangaController",["$scope","MangaService","CollectionService",function(e,n,t){e.alerts=[],e.legend="Add New Manga",e.uploadCover=!1,e.getCollections=function(e){return t.findByName(e).then(function(e){return e.data.items.map(function(e){return e.name})})},e.save=function(t){alert(e.mangaForm.$valid),e.mangaForm.$valid&&n.save(t).then(function(n){e.reset(),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},e.reset=function(){e.manga={collection:"",name:"",number:"",doIHaveIt:!1}},e.closeAlert=function(n){e.alerts.splice(n,1)}}]).controller("ListMangaController",["$scope","$timeout","MangaService","ngDialog",function(e,n,t,a){var o={collection:"",name:""};e.alerts=[];var i;e.$watchGroup(["manga.collection","manga.name"],function(e){(e[0]||e[1])&&(i&&n.cancel(i),i=n(function(){o={collection:e[0]?e[0]:"",name:e[1]?e[1]:""},l(1,0)},350))}),e.openRemoveDialog=function(n){e.mangaToRemove=n,a.openConfirm({template:"removeMangaTemplate",className:"ngdialog-theme-default",scope:e}).then(function(n){t.remove(n).then(function(n){l(e.bigCurrentPage,e.itemsPerPage*(e.bigCurrentPage-1)),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},function(){})};var l=function(n,a){e.itemsPerPage=10,e.maxSize=5,e.bigCurrentPage=n,t.paginate({manga:o,limit:e.itemsPerPage,skip:a}).then(function(n){e.items=n.data.items,e.bigTotalItems=n.data.totalRecords},function(e){})};e.setPage=function(n){e.bigCurrentPage=n},e.pageChanged=function(){l(e.bigCurrentPage,e.itemsPerPage*(e.bigCurrentPage-1))},l(1,0),e.closeAlert=function(n){e.alerts.splice(n,1)}}]).controller("UpdateMangaController",["$scope","$routeParams","MangaService","CollectionService","Upload",function(e,n,t,a,o){e.alerts=[],e.uploadCover=!0,e.legend="Update Manga",e.getCollections=function(e){return a.findByName(e).then(function(e){return e.data.items.map(function(e){return e.name})})};var i=null,l=function(){t.edit(n.id).then(function(n){e.manga=n.data.manga,i=angular.copy(e.manga)},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})};l(),e.save=function(n){e.mangaForm.$valid&&t.update(n).then(function(n){i=angular.copy(e.manga),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},e.reset=function(){l()},e.closeAlert=function(n){e.alerts.splice(n,1)},e.uploadCover=function(n,t){o.upload({url:"/api/mangas/cover/upload?mangaID="+t.id+"&directory="+t.collection+"&originalname="+t.collection+"_"+t.number,data:{file:n}}).then(function(n){e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})},function(e){})}}]),angular.module("publisher.controllers",["publisher.services","ngDialog"]).controller("NewPublisherController",["$scope","PublisherService",function(e,n){e.alerts=[],e.legend="Add New Publisher",e.save=function(t){e.publisherForm.$valid&&n.save(t).then(function(n){e.reset(),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},e.reset=function(){e.publisher={name:""}},e.closeAlert=function(n){e.alerts.splice(n,1)}}]).controller("ListPublisherController",["$scope","$route","$timeout","PublisherService","ngDialog",function(e,n,t,a,o){var i="";e.alerts=[];var l;e.$watch("name",function(e){e&&(l&&t.cancel(l),l=t(function(){i=e,r(1,0)},350))}),e.openRemoveDialog=function(n){e.publisherToRemove=n,o.openConfirm({template:"removePublisherTemplate",className:"ngdialog-theme-default",scope:e}).then(function(n){a.remove(n).then(function(n){r(e.bigCurrentPage,e.itemsPerPage*(e.bigCurrentPage-1)),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},function(){})};var r=function(n,t){e.itemsPerPage=10,e.maxSize=5,e.bigCurrentPage=n,a.paginate({name:i,limit:e.itemsPerPage,skip:t}).then(function(n){e.items=n.data.items,e.bigTotalItems=n.data.totalRecords},function(e){})};e.setPage=function(n){e.bigCurrentPage=n},e.pageChanged=function(){r(e.bigCurrentPage,e.itemsPerPage*(e.bigCurrentPage-1))},r(1,0),e.closeAlert=function(n){e.alerts.splice(n,1)}}]).controller("UpdatePublisherController",["$scope","$routeParams","PublisherService",function(e,n,t){e.alerts=[],e.legend="Update Publisher";var a=null,o=function(){t.edit(n.id).then(function(n){e.publisher=n.data.publisher,a=angular.copy(e.publisher)},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})};o(),e.save=function(n){e.publisherForm.$valid&&t.update(n).then(function(n){a=angular.copy(e.publisher),e.alerts.push({type:"success",msg:n.data.msg})},function(n){e.alerts.push({type:"warning",msg:n.data.msg})})},e.reset=function(){o()},e.closeAlert=function(n){e.alerts.splice(n,1)}}]),angular.module("collection.routes",["collection.controllers"]).config(["$routeProvider","$locationProvider",function(e,n){e.when("/views/collection",{templateUrl:"/assets/partials/collections/collection.html",controller:"NewCollectionController"}).when("/views/collections",{templateUrl:"/assets/partials/collections/collections.html",controller:"ListCollectionController"}).when("/views/collection/:id/edit",{templateUrl:"/assets/partials/collections/collection.html",controller:"UpdateCollectionController"}),n.html5Mode({enabled:!0,requireBase:!1})}]),angular.module("manga.routes",["manga.controllers"]).config(["$routeProvider","$locationProvider",function(e,n){e.when("/views/manga",{templateUrl:"/assets/partials/mangas/manga.html",controller:"NewMangaController"}).when("/views/mangas",{templateUrl:"/assets/partials/mangas/mangas.html",controller:"ListMangaController"}).when("/views/manga/:id/edit",{templateUrl:"/assets/partials/mangas/manga.html",controller:"UpdateMangaController"}),n.html5Mode({enabled:!0,requireBase:!1})}]),angular.module("publisher.routes",["publisher.controllers"]).config(["$routeProvider","$locationProvider",function(e,n){e.when("/views/publisher",{templateUrl:"/assets/partials/publishers/publisher.html",controller:"NewPublisherController"}).when("/views/publishers",{templateUrl:"/assets/partials/publishers/publishers.html",controller:"ListPublisherController"}).when("/views/publisher/:id/edit",{templateUrl:"/assets/partials/publishers/publisher.html",controller:"UpdatePublisherController"}),n.html5Mode({enabled:!0,requireBase:!1})}]),angular.module("collection.services",[]).factory("CollectionService",["$http",function(e){var n=function(n,t){return e({method:"POST",data:t,headers:{"Content-Type":"application/json"},url:n})},t=function(n,t){return e({method:"PUT",data:t,headers:{"Content-Type":"application/json"},url:n})},a=function(n){return e({method:"GET",headers:{"Content-Type":"application/json"},url:n})},o=function(n){return e({method:"DELETE",headers:{"Content-Type":"application/json"},url:n})};return{save:function(e){return n("/api/collections",e)},edit:function(e){return a("/api/collections/"+e+"/edit")},update:function(e){return t("/api/collections/"+e.id,e)},remove:function(e){return o("/api/collections/"+e)},findByName:function(e){return a("/api/collections/search?name="+e+"&limit=10&skip=0")},paginate:function(e){var n="/api/collections/search?";return null!==e.limit&&(n=n+"limit="+e.limit),null!==e.skip&&(n=n+"&skip="+e.skip),""!==e.collection.publisher&&(n=n+"&publisher="+e.collection.publisher),""!==e.collection.name&&(n=n+"&name="+e.collection.name),a(n)}}}]),angular.module("manga.services",[]).factory("MangaService",["$http",function(e){var n=function(n,t){return e({method:"POST",data:t,headers:{"Content-Type":"application/json"},url:n})},t=function(n,t){return e({method:"PUT",data:t,headers:{"Content-Type":"application/json"},url:n})},a=function(n){return e({method:"GET",headers:{"Content-Type":"application/json"},url:n})},o=function(n){return e({method:"DELETE",headers:{"Content-Type":"application/json"},url:n})};return{save:function(e){return alert(e.name),n("/api/mangas",e)},edit:function(e){return a("/api/mangas/"+e+"/edit")},update:function(e){return t("/api/mangas/"+e.id,e)},remove:function(e){return o("/api/mangas/"+e)},paginate:function(e){var n="/api/mangas/search?";return null!==e.limit&&(n=n+"limit="+e.limit),null!==e.skip&&(n=n+"&skip="+e.skip),""!==e.manga.collection&&(n=n+"&collection="+e.manga.collection),""!==e.manga.name&&(n=n+"&name="+e.manga.name),a(n)}}}]),angular.module("publisher.services",[]).factory("PublisherService",["$http",function(e){var n=function(n,t){return e({method:"POST",data:t,headers:{"Content-Type":"application/json"},url:n})},t=function(n,t){return e({method:"PUT",data:t,headers:{"Content-Type":"application/json"},url:n})},a=function(n){return e({method:"GET",headers:{"Content-Type":"application/json"},url:n})},o=function(n){return e({method:"DELETE",headers:{"Content-Type":"application/json"},url:n})};return{save:function(e){return n("/api/publishers",e)},edit:function(e){return a("/api/publishers/"+e+"/edit")},update:function(e){return t("/api/publishers/"+e.id,e)},remove:function(e){return o("/api/publishers/"+e)},findByName:function(e){return a("/api/publishers/search?name="+e+"&limit=10&skip=0")},paginate:function(e){var n="/api/publishers/search?";return null!==e.limit&&(n=n+"limit="+e.limit),null!==e.skip&&(n=n+"&skip="+e.skip),""!==e.name&&(n=n+"&name="+e.name),a(n)}}}]);